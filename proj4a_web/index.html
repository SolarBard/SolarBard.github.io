<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Face Morphing Project Write-Up</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }
        .container {
            width: 95%;
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1, h2, h3 {
            color: #005f99;
        }
        p {
            margin-bottom: 20px;
        }
        code {
            background-color: #f1f1f1;
            padding: 2px 6px;
            border-radius: 4px;
        }
        ul {
            margin-bottom: 20px;
            padding-left: 20px;
        }
        .image-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        figure {
            text-align: center;
        }
        .image-container img {
            width: 500px; /* Set fixed width to make both images equal */
            height: auto;
            border: 2px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        }
        figcaption {
            margin-top: 10px;
            font-style: italic;
            color: #555;
        }
    </style>
</head>
<body>
        <h1>Project 4: Image Warping and Mosaicing</h1>
        <h3 style="color: #333;">By Dmytro Krukovskyi</h3>
        <h2>Recovering Homographies</h2>
        <p>To warp images we need to find 3x3 matrix H with 8 degrees of freedom. For each corresponding pair of 
            points (x,y) and (x', y'), we can represent them in homogeneous coordinates and get the following:
        </p>  
        <div class="image-container">
            <img src="img/homog1.png" alt="">
        </div>
        <p>To recover the homography, we need at least four corresponding points between the two images. 
            Each correspondence provides two equations, and with four correspondences, we get a system of 8 equationsâ€”sufficient to solve for the 8 unknowns in H. 
            However, because such a system is sensitive to noise, using more than four correspondences is recommended. 
            This creates an overdetermined system that can be solved with least-squares.
            </p>
            <div class="image-container">
                <img src="img/homog2.png" alt="">
            </div>
        <h2>Warping the images</h2>
        <p>
            With the homography matrix H recovered, we can now warp an image to align it with a reference image. 
            This is achieved using inverse warping, which ensures that every pixel in the output image receives a valid value by mapping its position 
            back to the input image. 
        </p>
        <h2>Image rectification</h2>
        <p>Image rectification is a process that uses a homography to adjust an image such 
            that a selected object appears rectangular, correcting for perspective distortion. 
            This is particularly useful for scenes containing paintings, posters, or tiles, where known geometric 
            shapes can serve as reference objects.
        </p>
        <p>To perform rectification, we use a single input image and define correspondences between points in the image and a desired rectangular shape. 
            For example, if the photo contains a poster, you can manually select its four corners using a mouse-click interface and store their coordinates. 
            Next, you define the corresponding points as the corners of a square</p>
        <div class="image-container">
            <img src="img/projected_orig.png" alt="">
        </div>
        <div class="image-container">
            <img src="img/projected.png" alt="">
        </div>
        <div class="image-container">
            <img src="img/ex2.png" alt="">
        </div>
        <div class="image-container">
            <img src="img/ex_res.png" alt="">
        </div>
        <h2>Blend the images into a mosaic</h2>
        <p>To create the panorama from multiple images, the following procedure was followed:
        </p>
        <ol>
            <li>Create a Large Output Image and Predict the Mosaic Size</li>
            <p>The size of the output mosaic was determined by transforming the corners of both input images using the computed homography. 
                This allowed to predict the bounding box that would contain both images. A translation matrix was applied to ensure both 
                images fit into the shared coordinate space of the output canvas.
            </p>
            <li>Warp the Images Using Inverse Warping</li>
            <p>This approach ensures that each pixel in the output canvas receives a value by mapping back to the original images,
                 avoiding holes and gaps. The images were warped using: warpImage() function from the previous part.
            </p>

            <li>Blend images together</li>
            
          </ol>
          <div class="image-container">
            <img src="img/scu/left copy.JPG" alt="">
            <img src="img/scu/mid copy.JPG" alt="">
        </div>
        <div class="image-container">
            <img src="img/scu/new_panorama.jpg" alt="">
        </div>
        <p>To hide the seam i applied blending. I used laplacian stack that I implemented in project two. 
            I got the best results when using 3 levels laplacian stack.

        </p>
            <div class="image-container">
                <img src="img/scu/blend_panorama.jpg" alt="">
            </div>
            <p>Even though my approach is not ideal as there are some artifacts at thebottom of the image. 
                In general I am satisfied with the result. Here are some more examples.</p>
                <div class="image-container">
                    <img src="img/night/left.JPG" alt="">
                    <img src="img/night/mid.JPG" alt="">
                </div>  
                <div class="image-container">
                    <img src="img/night copy/new_panorama.jpg" alt="">
                </div>  
                <div class="image-container">
                    <img src="img/view/left.JPG" alt="">
                    <img src="img/view/mid.JPG" alt="">
                </div>  
                <div class="image-container">
                    <img src="img/view copy/new_panorama.jpg" alt="">
                </div>  
    </body>
</html>
